<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index – Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../assets/logo_Bruker_black.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html-5acaefe6876f2fc5583d865d9e6bf35c.min.css" rel="stylesheet" append-hash="true" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-3a01e2046221230fdceeea94b1ec5d67.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-29W4MW0Y2W"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-29W4MW0Y2W', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;family=Noto+Sans:wght@300;400;500;600;700&amp;family=Noto+Serif:ital,wght@1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    primary: "#0077c8", secondary: "#10b981", accent: "#6366f1",
                    "background-light": "#F5F7FA", "background-dark": "#ffffff",
                    "surface-light": "#ffffff", "text-main": "#1e293b", "text-sub": "#475569"
                },
                fontFamily: {
                    display: ["Space Grotesk", "sans-serif"],
                    serif: ["Noto Serif", "serif"],
                    mono: ["Space Mono", "monospace"],
                }
            }
        }
    }
</script>
<style>
    body { background-color: #F5F7FA; color: #1e293b; }
    .gradient-text { background: linear-gradient(135deg, #0077c8 0%, #10b981 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .editorial-card { background: #ffffff; border-radius: 2rem; box-shadow: 0 10px 30px -5px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; transition: all 0.3s ease; }
    .editorial-card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px -5px rgba(0,0,0,0.08); }
</style>


</head>

<body>





<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="42" data-source-offset="-26"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 41;"><span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>pubs <span class="op">=</span> <span class="cf">await</span> d3<span class="op">.</span><span class="fu">tsv</span>(<span class="st">"https://raw.githubusercontent.com/Nanostring-Biostats/ScratchSpaceDatasets/main/publication_tracker/spatial_publications.tsv"</span><span class="op">,</span> d3<span class="op">.</span><span class="at">autoType</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>manifest <span class="op">=</span> <span class="cf">await</span> d3<span class="op">.</span><span class="fu">csv</span>(<span class="st">"https://raw.githubusercontent.com/Nanostring-Biostats/ScratchSpaceDatasets/main/publication_tracker/manifest.csv"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>updatedDateStr <span class="op">=</span> {</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (manifest <span class="op">&amp;&amp;</span> manifest<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> manifest[<span class="dv">0</span>]<span class="op">.</span><span class="at">Last_Updated_UTC</span>) {</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ts <span class="op">=</span> manifest[<span class="dv">0</span>]<span class="op">.</span><span class="at">Last_Updated_UTC</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">' '</span><span class="op">,</span> <span class="st">'T'</span>) <span class="op">+</span> <span class="st">"Z"</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(ts)<span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> formatter <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">DateTimeFormat</span>(<span class="bu">navigator</span><span class="op">.</span><span class="at">language</span><span class="op">,</span> { <span class="dt">month</span><span class="op">:</span> <span class="st">'short'</span><span class="op">,</span> <span class="dt">day</span><span class="op">:</span> <span class="st">'numeric'</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> <span class="st">'numeric'</span> })<span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> formatter<span class="op">.</span><span class="fu">format</span>(d)<span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">'Unknown date'</span><span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">// Convert publication date string to year, filtering out pre-2008</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>pubs_clean <span class="op">=</span> pubs<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>d<span class="op">,</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Year</span><span class="op">:</span> d[<span class="st">"Publication Date"</span>] <span class="op">?</span> <span class="kw">new</span> <span class="bu">Date</span>(d[<span class="st">"Publication Date"</span>])<span class="op">.</span><span class="fu">getFullYear</span>() <span class="op">:</span> <span class="st">"N/A"</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Year</span> <span class="op">!==</span> <span class="st">"N/A"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Year</span> <span class="op">&gt;=</span> <span class="dv">2008</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="relative flex min-h-screen w-full flex-col group/design-root">
<main class="flex-grow flex flex-col">
<section class="relative min-h-[600px] flex items-center justify-center overflow-hidden py-10 lg:py-16">
<div class="absolute inset-0 z-0 overflow-hidden">
<div class="absolute -top-[20%] -right-[10%] w-[800px] h-[800px] rounded-full bg-gradient-to-br from-primary/10 to-secondary/10 blur-3xl opacity-60"></div>
<div class="absolute top-[40%] -left-[10%] w-[600px] h-[600px] rounded-full bg-gradient-to-tr from-secondary/10 to-primary/5 blur-3xl opacity-50"></div>
<div class="absolute inset-0 bg-[linear-gradient(rgba(0,0,0,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(0,0,0,0.02)_1px,transparent_1px)] bg-[size:40px_40px]"></div>
</div>
<div class="relative z-20 container mx-auto px-6 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
<div class="text-left">
<div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white border border-slate-200 shadow-sm text-slate-600 text-xs font-bold uppercase tracking-wider mb-8">
<span class="w-2 h-2 rounded-full bg-secondary animate-pulse"></span>
Editorial Volume 26.1
</div>
<h1 class="text-5xl md:text-6xl lg:text-7xl font-black uppercase tracking-tight text-slate-900 mb-8 leading-[1.1]">
  BEST-IN-CLASS<br>SOLUTIONS FOR<br>EVERY LAYER OF<br>BIOLOGY
</h1>
<p class="max-w-xl text-lg md:text-xl text-slate-600 font-light leading-relaxed mb-10 border-l-4 border-primary pl-6">
  Visualize and quantify DNA, RNA &amp; protein with unmatched depth and resolution using Bruker’s cohesive spatial biology portfolio
</p>
<a href="https://brukerspatialbiology.com/product-roadmap/" target="_blank" class="inline-flex h-12 items-center justify-center rounded-full px-8 bg-[#0077c8] text-white font-bold tracking-wide hover:bg-[#0077c8]/90 transition-all shadow-lg shadow-[#0077c8]/20">
  EXPLORE NEW INNOVATIONS
</a>
</div>

<div>
<a href="https://brukerspatialbiology.com/products/cellscape-precise-spatial-proteomics/cellscape-psp-overview" target="_blank" class="block relative h-[500px] w-full editorial-card overflow-hidden group">
<img alt="Cinematic laboratory glassware" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" src="https://brukerspatialbiology.com/wp-content/uploads/2026/02/WS_MK7173_RGB-Layers_feature.png">
<div class="absolute inset-0 bg-gradient-to-t from-slate-900/60 to-transparent flex items-end p-8">
<div class="text-white">
<p class="text-xs font-mono uppercase tracking-widest mb-1 text-secondary">Featured</p>
<h3 class="text-2xl font-serif italic anchored">CellScape™ Spatial Proteomics</h3>
</div>
</div>
</a>
</div>

</div>
</section>
<section class="py-10 relative bg-white border-y border-slate-100">
<div class="container mx-auto px-6">
<div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-6 w-full">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="112" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 111;"><span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class="w-full"&gt;</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;h2 class="text-4xl font-bold text-slate-900 mb-3 flex items-center gap-3"&gt;</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;span class="material-symbols-outlined text-primary text-4xl"&gt;show_chart&lt;/span&gt;</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="vs">    Publication Pulse</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/h2&gt;</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="flex flex-col xl:flex-row gap-6 justify-between items-start xl:items-end w-full mt-4"&gt;</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="flex-1 max-w-5xl"&gt;</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;p class="text-slate-500 text-lg font-medium leading-relaxed mb-3"&gt;</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a><span class="vs">        Cumulative publication growth across select Bruker Spatial Biology platforms. This database gets updated daily. </span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;span class="text-amber-700 font-bold bg-amber-50 px-2 py-0.5 rounded-md border border-amber-200 ml-1 shadow-sm"&gt;Note: This is a sample query, not an exhaustive list.&lt;/span&gt; </span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a><span class="vs">        This chart reflects live, automated data from OpenAlex, capturing papers that explicitly mention "AtoMx", "CosMx", "GeoMx", or "nCounter" in the title or abstract. It will miss publications using broader terminology.</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/p&gt;</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;p class="text-slate-400 text-sm flex items-center gap-1 font-medium"&gt;</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;span class="material-symbols-outlined text-sm"&gt;schedule&lt;/span&gt; Last updated from OpenAlex: </span><span class="sc">${</span>updatedDateStr<span class="sc">}</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/p&gt;</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;a href="https://brukerspatialbiology.com/resources/publications/?paged=1" target="_blank" class="shrink-0 inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-white hover:bg-slate-50 border border-slate-200 text-slate-700 font-bold shadow-sm transition-all hover:shadow-md group"&gt;</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;span class="material-symbols-outlined text-primary group-hover:scale-110 transition-transform"&gt;verified&lt;/span&gt;</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="vs">      See Additional Publications </span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/a&gt;</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
</div> <!-- Close header row -->
<div class="flex flex-col md:flex-row gap-6 lg:gap-8 items-start w-full">
<!-- Left side: The Chart -->
<div class="relative bg-[#F8FAFC] rounded-[2rem] border border-slate-100 p-8 shadow-inner flex flex-col gap-8 overflow-hidden min-h-[400px]" style="flex: 1.4; min-width: 0;">
  <div class="absolute inset-0" style="background-image: linear-gradient(#e2e8f0 1px, transparent 1px), linear-gradient(90deg, #e2e8f0 1px, transparent 1px); background-size: 40px 40px; opacity: 0.5;"></div>
  <div class="relative z-10 w-full overflow-x-auto min-h-[400px]">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="155" data-source-offset="-38"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 154;"><span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>filteredLinePubs <span class="op">=</span> pubs_clean<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedPlatforms<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> keep <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedPlatforms<span class="op">.</span><span class="fu">includes</span>(<span class="st">"CosMx"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Has_CosMx</span> <span class="op">===</span> <span class="st">'True'</span>) keep <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedPlatforms<span class="op">.</span><span class="fu">includes</span>(<span class="st">"GeoMx"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Has_GeoMx</span> <span class="op">===</span> <span class="st">'True'</span>) keep <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedPlatforms<span class="op">.</span><span class="fu">includes</span>(<span class="st">"AtoMx"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Has_AtoMx</span> <span class="op">===</span> <span class="st">'True'</span>) keep <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedPlatforms<span class="op">.</span><span class="fu">includes</span>(<span class="st">"nCounter"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Has_nCounter</span> <span class="op">===</span> <span class="st">'True'</span>) keep <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> keep<span class="op">;</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="co">// Generate cumulative data and capture top papers per year</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>chartData <span class="op">=</span> {</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minYear <span class="op">=</span> <span class="dv">2008</span><span class="op">;</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>pubs_clean<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Year</span>)<span class="op">.</span><span class="fu">filter</span>(y <span class="kw">=&gt;</span> <span class="bu">Number</span><span class="op">.</span><span class="fu">isInteger</span>(y)))<span class="op">;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cumulative <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calculate pre-2008 cumulative baseline</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> preBase <span class="op">=</span> filteredLinePubs<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="bu">Number</span><span class="op">.</span><span class="fu">isInteger</span>(d<span class="op">.</span><span class="at">Year</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">Year</span> <span class="op">&lt;</span> minYear)<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>  cumulative <span class="op">+=</span> preBase<span class="op">;</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> y <span class="op">=</span> minYear<span class="op">;</span> y <span class="op">&lt;=</span> maxYear<span class="op">;</span> y<span class="op">++</span>) {</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pubsInYear <span class="op">=</span> filteredLinePubs<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Year</span> <span class="op">===</span> y)<span class="op">;</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>    cumulative <span class="op">+=</span> pubsInYear<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Top 3 papers this year</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> topItems <span class="op">=</span> [<span class="op">...</span>pubsInYear]<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> (b[<span class="st">"Cited By"</span>] <span class="op">||</span> <span class="dv">0</span>) <span class="op">-</span> (a[<span class="st">"Cited By"</span>] <span class="op">||</span> <span class="dv">0</span>))<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>    result<span class="op">.</span><span class="fu">push</span>({ </span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>      <span class="dt">YearVal</span><span class="op">:</span> y<span class="op">,</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Year</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(y<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">,</span> </span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cumulative</span><span class="op">:</span> cumulative<span class="op">,</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>      <span class="dt">TopPapers</span><span class="op">:</span> topItems</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>mutable selectedYearVal <span class="op">=</span> <span class="kw">null</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>selectedYearData <span class="op">=</span> {</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Wait for chartData to populate</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>chartData <span class="op">||</span> chartData<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>chartData<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">YearVal</span>))<span class="op">;</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> selectedYearVal <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> maxYear <span class="op">:</span> selectedYearVal<span class="op">;</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> chartData<span class="op">.</span><span class="fu">find</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">YearVal</span> <span class="op">===</span> y) <span class="op">||</span> chartData[chartData<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a><span class="co">// Interactive Plot</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minYear <span class="op">=</span> <span class="dv">2008</span><span class="op">;</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>pubs_clean<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Year</span>)<span class="op">.</span><span class="fu">filter</span>(y <span class="kw">=&gt;</span> <span class="bu">Number</span><span class="op">.</span><span class="fu">isInteger</span>(y)))<span class="op">;</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> minDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(minYear<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(maxYear<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> node <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>      <span class="dt">background</span><span class="op">:</span> <span class="st">"transparent"</span><span class="op">,</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontFamily</span><span class="op">:</span> <span class="st">"Space Grotesk, sans-serif"</span><span class="op">,</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="st">"14px"</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"time"</span><span class="op">,</span> <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [minDate<span class="op">,</span> maxDate]<span class="op">,</span> <span class="dt">insetRight</span><span class="op">:</span> <span class="dv">20</span> }<span class="op">,</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Cumulative Publications"</span> }<span class="op">,</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">lineY</span>(chartData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Cumulative"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0077c8"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"catmull-rom"</span>})<span class="op">,</span></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(chartData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Cumulative"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"url(#gradient-blue)"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"catmull-rom"</span>})<span class="op">,</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Visible indicator for the selected year</span></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>([selectedYearData]<span class="op">.</span><span class="fu">filter</span>(<span class="bu">Boolean</span>)<span class="op">,</span> {</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> <span class="st">"Cumulative"</span><span class="op">,</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#0077c8"</span><span class="op">,</span></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>        <span class="dt">pointerEvents</span><span class="op">:</span> <span class="st">"none"</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(node)<span class="op">;</span></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Make SVG responsive</span></span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> <span class="st">"0 0 900 400"</span>)</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">"preserveAspectRatio"</span><span class="op">,</span> <span class="st">"xMidYMid meet"</span>)<span class="op">;</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Allow cursor to indicate interactivity</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)<span class="op">;</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add gradient def</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"defs"</span>)<span class="op">.</span><span class="fu">append</span>(<span class="st">"linearGradient"</span>)</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gradient-blue"</span>)</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="st">"0%"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="st">"0%"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="st">"0%"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"stop"</span>)</span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>([{<span class="dt">offset</span><span class="op">:</span> <span class="st">"0%"</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">"#0077c8"</span>}<span class="op">,</span> {<span class="dt">offset</span><span class="op">:</span> <span class="st">"100%"</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">"transparent"</span>}])</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"stop"</span>)</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"offset"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">offset</span>)</span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stop-color"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Bind click event directly to SVG to set nearest year</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> coords <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(<span class="bu">event</span><span class="op">,</span> svg<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> x <span class="op">=</span> coords[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> innerWidth <span class="op">=</span> <span class="dv">900</span> <span class="op">-</span> <span class="dv">50</span> <span class="op">-</span> <span class="dv">40</span><span class="op">;</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> plotX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(innerWidth<span class="op">,</span> x <span class="op">-</span> <span class="dv">50</span>))<span class="op">;</span> </span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ratio <span class="op">=</span> plotX <span class="op">/</span> innerWidth<span class="op">;</span></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> clickedTime <span class="op">=</span> minDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">+</span> ratio <span class="op">*</span> (maxDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> minDate<span class="op">.</span><span class="fu">getTime</span>())<span class="op">;</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> clickedYear <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(clickedTime)<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">;</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>    <span class="co">// snap to nearest existing chartData year</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (chartData<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> closest <span class="op">=</span> chartData<span class="op">.</span><span class="fu">reduce</span>((prev<span class="op">,</span> curr) <span class="kw">=&gt;</span> {</span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(curr<span class="op">.</span><span class="at">YearVal</span> <span class="op">-</span> clickedYear) <span class="op">&lt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(prev<span class="op">.</span><span class="at">YearVal</span> <span class="op">-</span> clickedYear)) <span class="op">?</span> curr <span class="op">:</span> prev<span class="op">;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>      mutable selectedYearVal <span class="op">=</span> closest<span class="op">.</span><span class="at">YearVal</span><span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-5" data-nodetype="expression">

</div>
</div>
</div>
</div>
  </div>
</div> <!-- End Left side Chart -->

<!-- Right side: Sidebar -->
<div class="flex flex-col gap-6 relative" style="flex: 1; min-width: 0;">
  <!-- Filters -->
  <div class="bg-slate-50 px-6 py-4 rounded-[2rem] border border-slate-200 w-full shadow-sm">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="296" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 295;"><span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;h3 class="text-sm font-bold text-slate-500 uppercase tracking-widest mb-3"&gt;Platforms&lt;/h3&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="298" data-source-offset="-98"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 297;"><span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a>viewof selectedPlatforms <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(</span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"CosMx"</span><span class="op">,</span> <span class="st">"GeoMx"</span><span class="op">,</span> <span class="st">"AtoMx"</span><span class="op">,</span> <span class="st">"nCounter"</span>]<span class="op">,</span> </span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> [<span class="st">"CosMx"</span><span class="op">,</span> <span class="st">"GeoMx"</span><span class="op">,</span> <span class="st">"AtoMx"</span><span class="op">,</span> <span class="st">"nCounter"</span>]}</span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
  </div>
  
  <!-- Top Papers Card -->
  <div class="w-full bg-white rounded-[2rem] border border-slate-200 p-6 shadow-sm flex flex-col flex-grow min-h-[300px]">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="310" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 309;"><span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;h3 class="text-sm font-bold text-slate-500 uppercase tracking-widest mb-4"&gt;Top Cited Papers &lt;span class="text-primary"&gt;</span><span class="sc">${</span>selectedYearData <span class="op">?</span> selectedYearData<span class="op">.</span><span class="at">YearVal</span> <span class="op">:</span> <span class="st">""</span><span class="sc">}</span><span class="vs">&lt;/span&gt;&lt;/h3&gt;</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>selectedYearData <span class="op">&amp;&amp;</span> selectedYearData<span class="op">.</span><span class="at">TopPapers</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> </span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a>  <span class="op">?</span> <span class="vs">`&lt;div class="flex flex-col gap-4"&gt;</span></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>selectedYearData<span class="op">.</span><span class="at">TopPapers</span><span class="op">.</span><span class="fu">map</span>((p<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`</span></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;a href="</span><span class="sc">${</span>p<span class="op">.</span><span class="at">DOI</span><span class="sc">}</span><span class="vs">" target="_blank" class="group block bg-slate-50 hover:bg-slate-100 rounded-xl p-4 border border-slate-100 transition-colors"&gt;</span></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="vs">           &lt;div class="flex items-start gap-3"&gt;</span></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="vs">             &lt;div class="w-6 h-6 rounded-full </span><span class="sc">${</span>i<span class="op">===</span><span class="dv">0</span> <span class="op">?</span> <span class="st">'bg-amber-100 text-amber-700'</span> <span class="op">:</span> <span class="st">'bg-slate-200 text-slate-600'</span><span class="sc">}</span><span class="vs"> flex items-center justify-center font-bold text-xs shrink-0"&gt;</span><span class="sc">${</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a><span class="vs">             &lt;div&gt;</span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a><span class="vs">               &lt;h4 class="text-slate-900 font-bold text-sm group-hover:text-primary transition-colors line-clamp-3 leading-snug"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Title</span><span class="sc">}</span><span class="vs">&lt;/h4&gt;</span></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a><span class="vs">               &lt;div class="text-[11px] text-slate-500 mt-2 flex flex-col gap-1"&gt;</span></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a><span class="vs">                 &lt;span class="font-serif italic line-clamp-1"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Journal</span><span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a><span class="vs">                 &lt;span class="font-mono text-emerald-700 font-bold"&gt;</span><span class="sc">${</span>p[<span class="st">"Cited By"</span>]<span class="sc">}</span><span class="vs"> Citations&lt;/span&gt;</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a><span class="vs">               &lt;/div&gt;</span></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a><span class="vs">             &lt;/div&gt;</span></span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a><span class="vs">           &lt;/div&gt;</span></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/a&gt;</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a><span class="vs">      `</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">''</span>)<span class="sc">}</span></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a><span class="vs">     &lt;/div&gt;`</span> </span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span> <span class="vs">`&lt;div class="flex-grow flex items-center justify-center text-slate-400 text-sm h-full italic text-center p-4"&gt;Click anywhere on the chart line to view the top cited papers for that year.&lt;/div&gt;`</span></span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a><span class="sc">}</span><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>
  </div>
</div> <!-- End Right side Sidebar -->

</div> <!-- End Flex Container -->
</div></section>
<section class="py-12 bg-[#F5F7FA]">
<div class="container mx-auto px-6">
<h3 class="text-xl font-bold text-slate-900 mb-6 font-display anchored">
Platform Metrics
</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- Card 1: Total Publications -->
<div class="bg-[#2a4534] rounded-[2rem] p-8 text-white relative overflow-hidden shadow-lg flex flex-col justify-between min-h-[220px]">
<div class="absolute top-0 right-0 p-6 opacity-30">
<p><span class="material-symbols-outlined text-4xl">description</span></p>
</div>
<div class="relative z-10 flex justify-between items-start">
<div class="p-2 bg-white/10 rounded-lg backdrop-blur-sm">
<p><span class="material-symbols-outlined text-xl">library_books</span></p>
</div>
<p><span class="text-xs font-bold uppercase tracking-wider text-white/60">Global</span></p>
</div>
<div class="relative z-10 mt-6">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="359" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 358;"><span id="cb7-359"><a href="#cb7-359" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;h4 class="text-5xl font-extrabold tracking-tight mb-2"&gt;</span><span class="sc">${</span>filteredLinePubs<span class="op">.</span><span class="at">length</span><span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs">&lt;/h4&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
<p class="text-sm font-medium text-white/70">
Total Publications
</p>
</div>
</div>
<!-- Card 2: Open Access Ratio -->
<div class="bg-white rounded-[2rem] p-8 border border-slate-200 shadow-sm flex flex-col justify-between min-h-[220px]">
<div class="flex justify-between items-start w-full">
<div class="p-2 bg-orange-50 rounded-lg text-orange-500">
<p><span class="material-symbols-outlined text-xl">lock_open</span></p>
</div>
<p><span class="text-xs font-bold uppercase tracking-wider text-slate-400">Ratio</span></p>
</div>
<div class="flex items-center justify-between gap-4 mt-4">
<div class="flex flex-col">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="378" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 377;"><span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a>oa_percent <span class="op">=</span> {</span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (filteredLinePubs<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// Prevents a divide-by-zero error if no boxes are checked</span></span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> oa <span class="op">=</span> filteredLinePubs<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="bu">String</span>(d[<span class="st">"Open Access"</span>])<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">===</span> <span class="st">'true'</span>)<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((oa <span class="op">/</span> filteredLinePubs<span class="op">.</span><span class="at">length</span>) <span class="op">*</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;h4 class="text-5xl font-extrabold text-slate-900 tracking-tight mb-2"&gt;</span><span class="sc">${</span>oa_percent<span class="sc">}</span><span class="vs">%&lt;/h4&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p class="text-sm font-medium text-slate-500">
Open Access Ratio
</p>
</div>
<div class="w-24 h-24 relative shrink-0">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="389" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 388;"><span id="cb9-389"><a href="#cb9-389" aria-hidden="true" tabindex="-1"></a>oa_ring <span class="op">=</span> {</span>
<span id="cb9-390"><a href="#cb9-390" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Quarto initializes 'this' as an empty object on the first run. </span></span>
<span id="cb9-391"><a href="#cb9-391" aria-hidden="true" tabindex="-1"></a>  <span class="co">// We must explicitly check if it has a tagName to ensure it's a real DOM element.</span></span>
<span id="cb9-392"><a href="#cb9-392" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> isFirstRender <span class="op">=</span> <span class="op">!</span>(<span class="kw">this</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">tagName</span>)<span class="op">;</span></span>
<span id="cb9-393"><a href="#cb9-393" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-394"><a href="#cb9-394" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Either create a new SVG or reuse the existing one</span></span>
<span id="cb9-395"><a href="#cb9-395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> node <span class="op">=</span> isFirstRender <span class="op">?</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)<span class="op">.</span><span class="fu">node</span>() <span class="op">:</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb9-396"><a href="#cb9-396" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(node)<span class="op">;</span></span>
<span id="cb9-397"><a href="#cb9-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-398"><a href="#cb9-398" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (isFirstRender) {</span>
<span id="cb9-399"><a href="#cb9-399" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"w-full h-full transform -rotate-90 pointer-events-none"</span>)</span>
<span id="cb9-400"><a href="#cb9-400" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> <span class="st">"0 0 36 36"</span>)<span class="op">;</span></span>
<span id="cb9-401"><a href="#cb9-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-402"><a href="#cb9-402" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 1. Draw the base gray ring</span></span>
<span id="cb9-403"><a href="#cb9-403" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb9-404"><a href="#cb9-404" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="st">"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"</span>)</span>
<span id="cb9-405"><a href="#cb9-405" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb9-406"><a href="#cb9-406" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#e2e8f0"</span>)</span>
<span id="cb9-407"><a href="#cb9-407" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"3"</span>)<span class="op">;</span></span>
<span id="cb9-408"><a href="#cb9-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-409"><a href="#cb9-409" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 2. Draw the orange active ring</span></span>
<span id="cb9-410"><a href="#cb9-410" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb9-411"><a href="#cb9-411" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"active-ring"</span>)</span>
<span id="cb9-412"><a href="#cb9-412" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="st">"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"</span>)</span>
<span id="cb9-413"><a href="#cb9-413" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb9-414"><a href="#cb9-414" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#f97316"</span>)</span>
<span id="cb9-415"><a href="#cb9-415" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"3"</span>)</span>
<span id="cb9-416"><a href="#cb9-416" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"0, 100"</span>) </span>
<span id="cb9-417"><a href="#cb9-417" aria-hidden="true" tabindex="-1"></a>       <span class="op">.</span><span class="fu">style</span>(<span class="st">"transition"</span><span class="op">,</span> <span class="st">"stroke-dasharray 1s cubic-bezier(0.4, 0, 0.2, 1)"</span>)<span class="op">;</span> <span class="co">// Smooth CSS easing</span></span>
<span id="cb9-418"><a href="#cb9-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-419"><a href="#cb9-419" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3. Trigger the initial animation slightly after the component mounts</span></span>
<span id="cb9-420"><a href="#cb9-420" aria-hidden="true" tabindex="-1"></a>    <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb9-421"><a href="#cb9-421" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(node)<span class="op">.</span><span class="fu">select</span>(<span class="st">".active-ring"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>oa_percent<span class="sc">}</span><span class="vs">, 100`</span>)<span class="op">;</span></span>
<span id="cb9-422"><a href="#cb9-422" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span> <span class="dv">50</span>)<span class="op">;</span></span>
<span id="cb9-423"><a href="#cb9-423" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-424"><a href="#cb9-424" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 4. REACTIVE UPDATE: If the SVG already exists, smoothly change the dasharray</span></span>
<span id="cb9-425"><a href="#cb9-425" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">".active-ring"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>oa_percent<span class="sc">}</span><span class="vs">, 100`</span>)<span class="op">;</span></span>
<span id="cb9-426"><a href="#cb9-426" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-427"><a href="#cb9-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-428"><a href="#cb9-428" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb9-429"><a href="#cb9-429" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
</div>
<!-- Card 3: Top Institutions -->
<div class="bg-white rounded-[2rem] p-8 border border-slate-200 shadow-sm flex flex-col min-h-[220px]">
<div class="flex justify-between items-start mb-6">
<div class="flex flex-col">
<div class="flex items-center gap-2 mb-1">
<h4 class="font-bold text-slate-700 text-sm uppercase tracking-wide anchored">
Top Institutions
</h4>
<p><span class="material-symbols-outlined text-slate-300 text-lg">domain</span></p>
</div>
</div>
<div class="flex flex-col items-end text-right">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="447" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 446;"><span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;span class="text-3xl font-extrabold text-slate-900 leading-none"&gt;</span><span class="sc">${</span>top_institutions<span class="op">.</span><span class="at">totalActive</span><span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;span class="text-[10px] text-slate-400 font-medium uppercase tracking-wider mt-1"&gt;Active Centers&lt;/span&gt;</span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div class="flex-grow flex flex-col justify-end">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="459" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 458;"><span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a>top_institutions <span class="op">=</span> {</span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Extract and split comma-separated institutions</span></span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> allInsts <span class="op">=</span> filteredLinePubs<span class="op">.</span><span class="fu">flatMap</span>(d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">Institutions</span> <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">trim</span>())<span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i <span class="op">!==</span> <span class="st">""</span>))<span class="op">;</span></span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> instCounts <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(allInsts<span class="op">,</span> v <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">length</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Sort and take top 10</span></span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sorted <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(instCounts<span class="op">,</span> ([name<span class="op">,</span> count]) <span class="kw">=&gt;</span> ({name<span class="op">,</span> count}))<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">count</span> <span class="op">-</span> a<span class="op">.</span><span class="at">count</span>)<span class="op">;</span></span>
<span id="cb11-465"><a href="#cb11-465" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb11-466"><a href="#cb11-466" aria-hidden="true" tabindex="-1"></a>    <span class="dt">totalActive</span><span class="op">:</span> instCounts<span class="op">.</span><span class="at">size</span><span class="op">,</span></span>
<span id="cb11-467"><a href="#cb11-467" aria-hidden="true" tabindex="-1"></a>    <span class="dt">top10</span><span class="op">:</span> sorted<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></span>
<span id="cb11-468"><a href="#cb11-468" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxCount</span><span class="op">:</span> sorted<span class="op">.</span><span class="at">length</span> <span class="op">?</span> sorted[<span class="dv">0</span>]<span class="op">.</span><span class="at">count</span> <span class="op">:</span> <span class="dv">1</span></span>
<span id="cb11-469"><a href="#cb11-469" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb11-470"><a href="#cb11-470" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-471"><a href="#cb11-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-472"><a href="#cb11-472" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb11-473"><a href="#cb11-473" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class="flex flex-col gap-2 w-full group/card cursor-default mt-auto"&gt;</span></span>
<span id="cb11-474"><a href="#cb11-474" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>top_institutions<span class="op">.</span><span class="at">top10</span><span class="op">.</span><span class="fu">map</span>((inst<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`</span></span>
<span id="cb11-475"><a href="#cb11-475" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="flex items-center gap-3 text-xs font-mono text-slate-400 transition-all duration-300 </span><span class="sc">${</span>i <span class="op">&gt;=</span> <span class="dv">5</span> <span class="op">?</span> <span class="st">'h-0 opacity-0 overflow-hidden group-hover/card:h-[18px] group-hover/card:opacity-100 group-hover/card:mt-1'</span> <span class="op">:</span> <span class="st">'h-[18px]'</span><span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb11-476"><a href="#cb11-476" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;span&gt;</span><span class="sc">${</span>i <span class="op">&lt;</span> <span class="dv">9</span> <span class="op">?</span> <span class="st">'0'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}${</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb11-477"><a href="#cb11-477" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="flex-grow h-2 bg-slate-100 rounded-full overflow-hidden"&gt;</span></span>
<span id="cb11-478"><a href="#cb11-478" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="h-full rounded-full </span><span class="sc">${</span>i<span class="op">===</span><span class="dv">0</span> <span class="op">?</span> <span class="st">'bg-[#2a4534]'</span> <span class="op">:</span> i<span class="op">===</span><span class="dv">1</span> <span class="op">?</span> <span class="st">'bg-[#f97316]'</span> <span class="op">:</span> <span class="st">'bg-slate-400'</span><span class="sc">}</span><span class="vs">" style="width: </span><span class="sc">${</span>(inst<span class="op">.</span><span class="at">count</span> <span class="op">/</span> top_institutions<span class="op">.</span><span class="at">maxCount</span>) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%"&gt;&lt;/div&gt;</span></span>
<span id="cb11-479"><a href="#cb11-479" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb11-480"><a href="#cb11-480" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;span class="font-bold text-slate-700 w-auto truncate max-w-[250px] text-right" title="</span><span class="sc">${</span>inst<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>inst<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb11-481"><a href="#cb11-481" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb11-482"><a href="#cb11-482" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">''</span>)<span class="sc">}</span></span>
<span id="cb11-483"><a href="#cb11-483" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="text-[10px] text-center text-slate-400 mt-2 italic group-hover/card:hidden"&gt;Hover to expand list&lt;/div&gt;</span></span>
<span id="cb11-484"><a href="#cb11-484" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb11-485"><a href="#cb11-485" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
<!-- Card 4: Publication Types -->
<div class="bg-white rounded-[2rem] p-8 border border-slate-200 shadow-sm flex flex-col min-h-[220px]">
<div class="flex justify-between items-start mb-6">
<div class="flex flex-col">
<div class="flex items-center gap-2 mb-1">
<h4 class="font-bold text-slate-700 text-sm uppercase tracking-wide anchored">
Top Types
</h4>
<p><span class="material-symbols-outlined text-slate-300 text-lg">category</span></p>
</div>
</div>
<div class="flex flex-col items-end text-right">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="501" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 500;"><span id="cb12-501"><a href="#cb12-501" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb12-502"><a href="#cb12-502" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;span class="text-3xl font-extrabold text-slate-900 leading-none"&gt;</span><span class="sc">${</span>top_types<span class="op">.</span><span class="at">totalActive</span><span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb12-503"><a href="#cb12-503" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;span class="text-[10px] text-slate-400 font-medium uppercase tracking-wider mt-1"&gt;Distinct Formats&lt;/span&gt;</span></span>
<span id="cb12-504"><a href="#cb12-504" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div class="flex-grow flex flex-col justify-end">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="513" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 512;"><span id="cb13-513"><a href="#cb13-513" aria-hidden="true" tabindex="-1"></a>top_types <span class="op">=</span> {</span>
<span id="cb13-514"><a href="#cb13-514" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Use filteredLinePubs so types react to platform selection</span></span>
<span id="cb13-515"><a href="#cb13-515" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> allTypes <span class="op">=</span> filteredLinePubs<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Type</span> <span class="op">||</span> <span class="st">"Unknown"</span>)<span class="op">;</span></span>
<span id="cb13-516"><a href="#cb13-516" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> typeCounts <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(allTypes<span class="op">,</span> v <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">length</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb13-517"><a href="#cb13-517" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Sort and take top 10</span></span>
<span id="cb13-518"><a href="#cb13-518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sorted <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(typeCounts<span class="op">,</span> ([name<span class="op">,</span> count]) <span class="kw">=&gt;</span> ({name<span class="op">,</span> count}))<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">count</span> <span class="op">-</span> a<span class="op">.</span><span class="at">count</span>)<span class="op">;</span></span>
<span id="cb13-519"><a href="#cb13-519" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb13-520"><a href="#cb13-520" aria-hidden="true" tabindex="-1"></a>    <span class="dt">totalActive</span><span class="op">:</span> typeCounts<span class="op">.</span><span class="at">size</span><span class="op">,</span></span>
<span id="cb13-521"><a href="#cb13-521" aria-hidden="true" tabindex="-1"></a>    <span class="dt">top10</span><span class="op">:</span> sorted<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></span>
<span id="cb13-522"><a href="#cb13-522" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxCount</span><span class="op">:</span> sorted<span class="op">.</span><span class="at">length</span> <span class="op">?</span> sorted[<span class="dv">0</span>]<span class="op">.</span><span class="at">count</span> <span class="op">:</span> <span class="dv">1</span></span>
<span id="cb13-523"><a href="#cb13-523" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb13-524"><a href="#cb13-524" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-525"><a href="#cb13-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-526"><a href="#cb13-526" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb13-527"><a href="#cb13-527" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class="flex flex-col gap-2 w-full group/card cursor-default mt-auto"&gt;</span></span>
<span id="cb13-528"><a href="#cb13-528" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>top_types<span class="op">.</span><span class="at">top10</span><span class="op">.</span><span class="fu">map</span>((typeObj<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`</span></span>
<span id="cb13-529"><a href="#cb13-529" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="flex items-center gap-3 text-xs font-mono text-slate-400 transition-all duration-300 </span><span class="sc">${</span>i <span class="op">&gt;=</span> <span class="dv">5</span> <span class="op">?</span> <span class="st">'h-0 opacity-0 overflow-hidden group-hover/card:h-[18px] group-hover/card:opacity-100 group-hover/card:mt-1'</span> <span class="op">:</span> <span class="st">'h-[18px]'</span><span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb13-530"><a href="#cb13-530" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;span&gt;</span><span class="sc">${</span>i <span class="op">&lt;</span> <span class="dv">9</span> <span class="op">?</span> <span class="st">'0'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}${</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb13-531"><a href="#cb13-531" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="flex-grow h-2 bg-slate-100 rounded-full overflow-hidden"&gt;</span></span>
<span id="cb13-532"><a href="#cb13-532" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="h-full rounded-full </span><span class="sc">${</span>i<span class="op">===</span><span class="dv">0</span> <span class="op">?</span> <span class="st">'bg-sky-500'</span> <span class="op">:</span> i<span class="op">===</span><span class="dv">1</span> <span class="op">?</span> <span class="st">'bg-violet-500'</span> <span class="op">:</span> <span class="st">'bg-slate-400'</span><span class="sc">}</span><span class="vs">" style="width: </span><span class="sc">${</span>(typeObj<span class="op">.</span><span class="at">count</span> <span class="op">/</span> top_types<span class="op">.</span><span class="at">maxCount</span>) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%"&gt;&lt;/div&gt;</span></span>
<span id="cb13-533"><a href="#cb13-533" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb13-534"><a href="#cb13-534" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;span class="font-bold text-slate-700 w-auto truncate max-w-[250px] text-right capitalize" title="</span><span class="sc">${</span>typeObj<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>typeObj<span class="op">.</span><span class="at">name</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">'-'</span><span class="op">,</span> <span class="st">' '</span>)<span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb13-535"><a href="#cb13-535" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb13-536"><a href="#cb13-536" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">''</span>)<span class="sc">}</span></span>
<span id="cb13-537"><a href="#cb13-537" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class="text-[10px] text-center text-slate-400 mt-2 italic group-hover/card:hidden"&gt;Hover to expand list&lt;/div&gt;</span></span>
<span id="cb13-538"><a href="#cb13-538" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb13-539"><a href="#cb13-539" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-12-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-12-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="mt-auto py-24 bg-white border-t border-slate-200">
<div class="container mx-auto px-6">
<div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6">
<div class="flex flex-col gap-2">
<h2 class="text-4xl font-bold text-slate-900 tracking-tight font-serif anchored">
Scientific Database
</h2>
<p class="text-slate-500 text-lg">
Search within this database.
</p>
</div>
</div>
<div class="bg-white rounded-[2rem] border border-slate-200 shadow-soft overflow-hidden">
<div class="bg-slate-50 px-8 py-4 border-b border-slate-200 flex flex-wrap items-center justify-between gap-4">
<div class="relative flex-grow max-w-lg">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="560" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 559;"><span id="cb14-560"><a href="#cb14-560" aria-hidden="true" tabindex="-1"></a>viewof searchTerm <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Search for papers (e.g., 'Lung Cancer')..."</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="flex items-center gap-3">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="567" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 566;"><span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a>viewof sortBy <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"Year"</span><span class="op">,</span> <span class="st">"Cited By"</span><span class="op">,</span> <span class="st">"Title"</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort By:"</span>})</span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a>viewof sortOrder <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"Desc"</span><span class="op">,</span> <span class="st">"Asc"</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">"Desc"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
</div>
<div class="grid grid-cols-12 gap-4 px-8 py-3 bg-slate-50/50 border-b border-slate-100 text-xs font-bold text-slate-400 uppercase tracking-wider">
<div class="col-span-5">
Publication Title
</div>
<div class="col-span-2">
Journal
</div>
<div class="col-span-1">
Year
</div>
<div class="col-span-1">
Citations
</div>
<div class="col-span-1">
Access
</div>
<div class="col-span-2 text-right">
Relevance
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="583" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 582;"><span id="cb16-583"><a href="#cb16-583" aria-hidden="true" tabindex="-1"></a>filtered_pubs <span class="op">=</span> {</span>
<span id="cb16-584"><a href="#cb16-584" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Filter</span></span>
<span id="cb16-585"><a href="#cb16-585" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> filtered <span class="op">=</span> pubs_clean<span class="op">.</span><span class="fu">filter</span>(p <span class="kw">=&gt;</span> </span>
<span id="cb16-586"><a href="#cb16-586" aria-hidden="true" tabindex="-1"></a>      <span class="bu">String</span>(p<span class="op">.</span><span class="at">Title</span> <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">includes</span>(searchTerm<span class="op">.</span><span class="fu">toLowerCase</span>()) <span class="op">||</span> </span>
<span id="cb16-587"><a href="#cb16-587" aria-hidden="true" tabindex="-1"></a>      <span class="bu">String</span>(p<span class="op">.</span><span class="at">Authors</span> <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">includes</span>(searchTerm<span class="op">.</span><span class="fu">toLowerCase</span>())</span>
<span id="cb16-588"><a href="#cb16-588" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb16-589"><a href="#cb16-589" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-590"><a href="#cb16-590" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Sort</span></span>
<span id="cb16-591"><a href="#cb16-591" aria-hidden="true" tabindex="-1"></a>  filtered<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb16-592"><a href="#cb16-592" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> valA <span class="op">=</span> a[sortBy]<span class="op">;</span></span>
<span id="cb16-593"><a href="#cb16-593" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> valB <span class="op">=</span> b[sortBy]<span class="op">;</span></span>
<span id="cb16-594"><a href="#cb16-594" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-595"><a href="#cb16-595" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Numeric fallback</span></span>
<span id="cb16-596"><a href="#cb16-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (sortBy <span class="op">===</span> <span class="st">"Year"</span> <span class="op">||</span> sortBy <span class="op">===</span> <span class="st">"Cited By"</span>) {</span>
<span id="cb16-597"><a href="#cb16-597" aria-hidden="true" tabindex="-1"></a>      valA <span class="op">=</span> <span class="bu">Number</span>(valA) <span class="op">||</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-598"><a href="#cb16-598" aria-hidden="true" tabindex="-1"></a>      valB <span class="op">=</span> <span class="bu">Number</span>(valB) <span class="op">||</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-599"><a href="#cb16-599" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> sortOrder <span class="op">===</span> <span class="st">"Desc"</span> <span class="op">?</span> valB <span class="op">-</span> valA <span class="op">:</span> valA <span class="op">-</span> valB<span class="op">;</span></span>
<span id="cb16-600"><a href="#cb16-600" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-601"><a href="#cb16-601" aria-hidden="true" tabindex="-1"></a>      <span class="co">// String compare</span></span>
<span id="cb16-602"><a href="#cb16-602" aria-hidden="true" tabindex="-1"></a>      valA <span class="op">=</span> <span class="bu">String</span>(valA <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb16-603"><a href="#cb16-603" aria-hidden="true" tabindex="-1"></a>      valB <span class="op">=</span> <span class="bu">String</span>(valB <span class="op">||</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb16-604"><a href="#cb16-604" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (valA <span class="op">&lt;</span> valB) <span class="cf">return</span> sortOrder <span class="op">===</span> <span class="st">"Desc"</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-605"><a href="#cb16-605" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (valA <span class="op">&gt;</span> valB) <span class="cf">return</span> sortOrder <span class="op">===</span> <span class="st">"Desc"</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-606"><a href="#cb16-606" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-607"><a href="#cb16-607" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-608"><a href="#cb16-608" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb16-609"><a href="#cb16-609" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-610"><a href="#cb16-610" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> filtered<span class="op">;</span></span>
<span id="cb16-611"><a href="#cb16-611" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-612"><a href="#cb16-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-613"><a href="#cb16-613" aria-hidden="true" tabindex="-1"></a><span class="co">// Implement basic pagination so the page doesn't lag if they expand it</span></span>
<span id="cb16-614"><a href="#cb16-614" aria-hidden="true" tabindex="-1"></a>viewof pageIndex <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(filtered_pubs<span class="op">.</span><span class="at">length</span> <span class="op">/</span> <span class="dv">20</span>) <span class="op">-</span> <span class="dv">1</span>)]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Page"</span>})</span>
<span id="cb16-615"><a href="#cb16-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-616"><a href="#cb16-616" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb16-617"><a href="#cb16-617" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class="divide-y divide-slate-100"&gt;</span></span>
<span id="cb16-618"><a href="#cb16-618" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>filtered_pubs<span class="op">.</span><span class="fu">slice</span>(pageIndex <span class="op">*</span> <span class="dv">20</span><span class="op">,</span> (pageIndex <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">20</span>)<span class="op">.</span><span class="fu">map</span>(p <span class="kw">=&gt;</span> <span class="fu">html</span><span class="vs">`</span></span>
<span id="cb16-619"><a href="#cb16-619" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="group hover:bg-[#F0F9FF] transition-colors cursor-pointer"&gt;</span></span>
<span id="cb16-620"><a href="#cb16-620" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="grid grid-cols-12 gap-4 px-8 py-5 items-center"&gt;</span></span>
<span id="cb16-621"><a href="#cb16-621" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-5"&gt;</span></span>
<span id="cb16-622"><a href="#cb16-622" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;h4 class="text-slate-900 font-bold text-lg group-hover:text-primary transition-colors"&gt;</span></span>
<span id="cb16-623"><a href="#cb16-623" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;a href="</span><span class="sc">${</span>p<span class="op">.</span><span class="at">DOI</span><span class="sc">}</span><span class="vs">" target="_blank"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Title</span><span class="sc">}</span><span class="vs">&lt;/a&gt;</span></span>
<span id="cb16-624"><a href="#cb16-624" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/h4&gt;</span></span>
<span id="cb16-625"><a href="#cb16-625" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;p class="text-sm text-slate-500 mt-1 line-clamp-1"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Authors</span><span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb16-626"><a href="#cb16-626" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/div&gt;</span></span>
<span id="cb16-627"><a href="#cb16-627" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-2 text-slate-700 font-serif italic line-clamp-2"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Journal</span><span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb16-628"><a href="#cb16-628" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-1 text-slate-500 font-mono"&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">Year</span><span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb16-629"><a href="#cb16-629" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-1 text-slate-500 font-mono"&gt;&lt;span class="bg-slate-100 border border-slate-200 text-slate-600 px-3 py-0.5 rounded-full text-xs font-bold"&gt;</span><span class="sc">${</span>p[<span class="st">"Cited By"</span>] <span class="op">||</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb16-630"><a href="#cb16-630" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-1"&gt;</span></span>
<span id="cb16-631"><a href="#cb16-631" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span><span class="bu">String</span>(p[<span class="st">"Open Access"</span>])<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">===</span> <span class="st">'true'</span> <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[10px] font-bold bg-orange-50 text-orange-600 border border-orange-100 uppercase tracking-wider"&gt;&lt;span class="material-symbols-outlined text-[12px]"&gt;lock_open&lt;/span&gt; Open&lt;/span&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb16-632"><a href="#cb16-632" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/div&gt;</span></span>
<span id="cb16-633"><a href="#cb16-633" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="col-span-2 text-right"&gt;</span></span>
<span id="cb16-634"><a href="#cb16-634" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span>p<span class="op">.</span><span class="at">Has_CosMx</span> <span class="op">==</span> <span class="st">'True'</span> <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;span class="inline-flex m-0.5 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"&gt;CosMx&lt;/span&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb16-635"><a href="#cb16-635" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span>p<span class="op">.</span><span class="at">Has_GeoMx</span> <span class="op">==</span> <span class="st">'True'</span> <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;span class="inline-flex m-0.5 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800"&gt;GeoMx&lt;/span&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb16-636"><a href="#cb16-636" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span>p<span class="op">.</span><span class="at">Has_AtoMx</span> <span class="op">==</span> <span class="st">'True'</span> <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;span class="inline-flex m-0.5 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"&gt;AtoMx&lt;/span&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb16-637"><a href="#cb16-637" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span>p<span class="op">.</span><span class="at">Has_nCounter</span> <span class="op">==</span> <span class="st">'True'</span> <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;span class="inline-flex m-0.5 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"&gt;nCounter&lt;/span&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb16-638"><a href="#cb16-638" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/div&gt;</span></span>
<span id="cb16-639"><a href="#cb16-639" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb16-640"><a href="#cb16-640" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb16-641"><a href="#cb16-641" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>)<span class="sc">}</span></span>
<span id="cb16-642"><a href="#cb16-642" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class="bg-slate-50 px-8 py-4 border-t border-slate-200 flex justify-between items-center"&gt;</span></span>
<span id="cb16-643"><a href="#cb16-643" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;span class="text-xs text-slate-500"&gt;Showing page </span><span class="sc">${</span>pageIndex <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> of </span><span class="sc">${</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(filtered_pubs<span class="op">.</span><span class="at">length</span> <span class="op">/</span> <span class="dv">20</span>))<span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span>filtered_pubs<span class="op">.</span><span class="at">length</span><span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs"> total results)&lt;/span&gt;</span></span>
<span id="cb16-644"><a href="#cb16-644" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb16-645"><a href="#cb16-645" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb16-646"><a href="#cb16-646" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</section>
</main>
</div>



<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIEZldGNoIHB1YmxpY2F0aW9uIGRhdGFcbnB1YnMgPSBhd2FpdCBkMy50c3YoXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vTmFub3N0cmluZy1CaW9zdGF0cy9TY3JhdGNoU3BhY2VEYXRhc2V0cy9tYWluL3B1YmxpY2F0aW9uX3RyYWNrZXIvc3BhdGlhbF9wdWJsaWNhdGlvbnMudHN2XCIsIGQzLmF1dG9UeXBlKVxubWFuaWZlc3QgPSBhd2FpdCBkMy5jc3YoXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vTmFub3N0cmluZy1CaW9zdGF0cy9TY3JhdGNoU3BhY2VEYXRhc2V0cy9tYWluL3B1YmxpY2F0aW9uX3RyYWNrZXIvbWFuaWZlc3QuY3N2XCIpXG5cbnVwZGF0ZWREYXRlU3RyID0ge1xuICBpZiAobWFuaWZlc3QgJiYgbWFuaWZlc3QubGVuZ3RoID4gMCAmJiBtYW5pZmVzdFswXS5MYXN0X1VwZGF0ZWRfVVRDKSB7XG4gICAgY29uc3QgdHMgPSBtYW5pZmVzdFswXS5MYXN0X1VwZGF0ZWRfVVRDLnJlcGxhY2UoJyAnLCAnVCcpICsgXCJaXCI7XG4gICAgY29uc3QgZCA9IG5ldyBEYXRlKHRzKTtcbiAgICBjb25zdCBmb3JtYXR0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChuYXZpZ2F0b3IubGFuZ3VhZ2UsIHsgbW9udGg6ICdzaG9ydCcsIGRheTogJ251bWVyaWMnLCB5ZWFyOiAnbnVtZXJpYycgfSk7XG4gICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQoZCk7XG4gIH1cbiAgcmV0dXJuICdVbmtub3duIGRhdGUnO1xufVxuXG4vLyBDb252ZXJ0IHB1YmxpY2F0aW9uIGRhdGUgc3RyaW5nIHRvIHllYXIsIGZpbHRlcmluZyBvdXQgcHJlLTIwMDhcbnB1YnNfY2xlYW4gPSBwdWJzLm1hcChkID0+IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kLFxuICAgIFllYXI6IGRbXCJQdWJsaWNhdGlvbiBEYXRlXCJdID8gbmV3IERhdGUoZFtcIlB1YmxpY2F0aW9uIERhdGVcIl0pLmdldEZ1bGxZZWFyKCkgOiBcIk4vQVwiXG4gIH1cbn0pLmZpbHRlcihkID0+IGQuWWVhciAhPT0gXCJOL0FcIiAmJiBkLlllYXIgPj0gMjAwOClcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgXG48ZGl2IGNsYXNzPVwidy1mdWxsXCI+XG4gIDxoMiBjbGFzcz1cInRleHQtNHhsIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTkwMCBtYi0zIGZsZXggaXRlbXMtY2VudGVyIGdhcC0zXCI+XG4gICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkIHRleHQtcHJpbWFyeSB0ZXh0LTR4bFwiPnNob3dfY2hhcnQ8L3NwYW4+XG4gICAgUHVibGljYXRpb24gUHVsc2VcbiAgPC9oMj5cbiAgXG4gIDxkaXYgY2xhc3M9XCJmbGV4IGZsZXgtY29sIHhsOmZsZXgtcm93IGdhcC02IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCB4bDppdGVtcy1lbmQgdy1mdWxsIG10LTRcIj5cbiAgICA8ZGl2IGNsYXNzPVwiZmxleC0xIG1heC13LTV4bFwiPlxuICAgICAgPHAgY2xhc3M9XCJ0ZXh0LXNsYXRlLTUwMCB0ZXh0LWxnIGZvbnQtbWVkaXVtIGxlYWRpbmctcmVsYXhlZCBtYi0zXCI+XG4gICAgICAgIEN1bXVsYXRpdmUgcHVibGljYXRpb24gZ3Jvd3RoIGFjcm9zcyBzZWxlY3QgQnJ1a2VyIFNwYXRpYWwgQmlvbG9neSBwbGF0Zm9ybXMuIFRoaXMgZGF0YWJhc2UgZ2V0cyB1cGRhdGVkIGRhaWx5LiBcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0LWFtYmVyLTcwMCBmb250LWJvbGQgYmctYW1iZXItNTAgcHgtMiBweS0wLjUgcm91bmRlZC1tZCBib3JkZXIgYm9yZGVyLWFtYmVyLTIwMCBtbC0xIHNoYWRvdy1zbVwiPk5vdGU6IFRoaXMgaXMgYSBzYW1wbGUgcXVlcnksIG5vdCBhbiBleGhhdXN0aXZlIGxpc3QuPC9zcGFuPiBcbiAgICAgICAgVGhpcyBjaGFydCByZWZsZWN0cyBsaXZlLCBhdXRvbWF0ZWQgZGF0YSBmcm9tIE9wZW5BbGV4LCBjYXB0dXJpbmcgcGFwZXJzIHRoYXQgZXhwbGljaXRseSBtZW50aW9uIFwiQXRvTXhcIiwgXCJDb3NNeFwiLCBcIkdlb014XCIsIG9yIFwibkNvdW50ZXJcIiBpbiB0aGUgdGl0bGUgb3IgYWJzdHJhY3QuIEl0IHdpbGwgbWlzcyBwdWJsaWNhdGlvbnMgdXNpbmcgYnJvYWRlciB0ZXJtaW5vbG9neS5cbiAgICAgIDwvcD5cbiAgICAgIDxwIGNsYXNzPVwidGV4dC1zbGF0ZS00MDAgdGV4dC1zbSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSBmb250LW1lZGl1bVwiPlxuICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgdGV4dC1zbVwiPnNjaGVkdWxlPC9zcGFuPiBMYXN0IHVwZGF0ZWQgZnJvbSBPcGVuQWxleDogJHt1cGRhdGVkRGF0ZVN0cn1cbiAgICAgIDwvcD5cbiAgICA8L2Rpdj5cbiAgICBcbiAgICA8YSBocmVmPVwiaHR0cHM6Ly9icnVrZXJzcGF0aWFsYmlvbG9neS5jb20vcmVzb3VyY2VzL3B1YmxpY2F0aW9ucy8/cGFnZWQ9MVwiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzPVwic2hyaW5rLTAgaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHB4LTYgcHktMyByb3VuZGVkLXhsIGJnLXdoaXRlIGhvdmVyOmJnLXNsYXRlLTUwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHRleHQtc2xhdGUtNzAwIGZvbnQtYm9sZCBzaGFkb3ctc20gdHJhbnNpdGlvbi1hbGwgaG92ZXI6c2hhZG93LW1kIGdyb3VwXCI+XG4gICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgdGV4dC1wcmltYXJ5IGdyb3VwLWhvdmVyOnNjYWxlLTExMCB0cmFuc2l0aW9uLXRyYW5zZm9ybVwiPnZlcmlmaWVkPC9zcGFuPlxuICAgICAgU2VlIEFkZGl0aW9uYWwgUHVibGljYXRpb25zIFxuICAgIDwvYT5cbiAgPC9kaXY+XG48L2Rpdj5cbmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gRmlsdGVyIHB1YnMgYnkgc2VsZWN0ZWQgcGxhdGZvcm1zXG5maWx0ZXJlZExpbmVQdWJzID0gcHVic19jbGVhbi5maWx0ZXIoZCA9PiB7XG4gIGlmIChzZWxlY3RlZFBsYXRmb3Jtcy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcbiAgbGV0IGtlZXAgPSBmYWxzZTtcbiAgaWYgKHNlbGVjdGVkUGxhdGZvcm1zLmluY2x1ZGVzKFwiQ29zTXhcIikgJiYgZC5IYXNfQ29zTXggPT09ICdUcnVlJykga2VlcCA9IHRydWU7XG4gIGlmIChzZWxlY3RlZFBsYXRmb3Jtcy5pbmNsdWRlcyhcIkdlb014XCIpICYmIGQuSGFzX0dlb014ID09PSAnVHJ1ZScpIGtlZXAgPSB0cnVlO1xuICBpZiAoc2VsZWN0ZWRQbGF0Zm9ybXMuaW5jbHVkZXMoXCJBdG9NeFwiKSAmJiBkLkhhc19BdG9NeCA9PT0gJ1RydWUnKSBrZWVwID0gdHJ1ZTtcbiAgaWYgKHNlbGVjdGVkUGxhdGZvcm1zLmluY2x1ZGVzKFwibkNvdW50ZXJcIikgJiYgZC5IYXNfbkNvdW50ZXIgPT09ICdUcnVlJykga2VlcCA9IHRydWU7XG4gIHJldHVybiBrZWVwO1xufSlcblxuLy8gR2VuZXJhdGUgY3VtdWxhdGl2ZSBkYXRhIGFuZCBjYXB0dXJlIHRvcCBwYXBlcnMgcGVyIHllYXJcbmNoYXJ0RGF0YSA9IHtcbiAgY29uc3QgbWluWWVhciA9IDIwMDg7XG4gIGNvbnN0IG1heFllYXIgPSBNYXRoLm1heCguLi5wdWJzX2NsZWFuLm1hcChkID0+IGQuWWVhcikuZmlsdGVyKHkgPT4gTnVtYmVyLmlzSW50ZWdlcih5KSkpO1xuICBsZXQgY3VtdWxhdGl2ZSA9IDA7XG4gIGNvbnN0IHJlc3VsdCA9IFtdO1xuICBcbiAgLy8gQ2FsY3VsYXRlIHByZS0yMDA4IGN1bXVsYXRpdmUgYmFzZWxpbmVcbiAgY29uc3QgcHJlQmFzZSA9IGZpbHRlcmVkTGluZVB1YnMuZmlsdGVyKGQgPT4gTnVtYmVyLmlzSW50ZWdlcihkLlllYXIpICYmIGQuWWVhciA8IG1pblllYXIpLmxlbmd0aDtcbiAgY3VtdWxhdGl2ZSArPSBwcmVCYXNlO1xuICBcbiAgZm9yIChsZXQgeSA9IG1pblllYXI7IHkgPD0gbWF4WWVhcjsgeSsrKSB7XG4gICAgY29uc3QgcHVic0luWWVhciA9IGZpbHRlcmVkTGluZVB1YnMuZmlsdGVyKGQgPT4gZC5ZZWFyID09PSB5KTtcbiAgICBjdW11bGF0aXZlICs9IHB1YnNJblllYXIubGVuZ3RoO1xuICAgIFxuICAgIC8vIFRvcCAzIHBhcGVycyB0aGlzIHllYXJcbiAgICBjb25zdCB0b3BJdGVtcyA9IFsuLi5wdWJzSW5ZZWFyXS5zb3J0KChhLGIpID0+IChiW1wiQ2l0ZWQgQnlcIl0gfHwgMCkgLSAoYVtcIkNpdGVkIEJ5XCJdIHx8IDApKS5zbGljZSgwLCAzKTtcbiAgICBcbiAgICByZXN1bHQucHVzaCh7IFxuICAgICAgWWVhclZhbDogeSxcbiAgICAgIFllYXI6IG5ldyBEYXRlKHksIDAsIDEpLCBcbiAgICAgIEN1bXVsYXRpdmU6IGN1bXVsYXRpdmUsXG4gICAgICBUb3BQYXBlcnM6IHRvcEl0ZW1zXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubXV0YWJsZSBzZWxlY3RlZFllYXJWYWwgPSBudWxsXG5cbnNlbGVjdGVkWWVhckRhdGEgPSB7XG4gIC8vIFdhaXQgZm9yIGNoYXJ0RGF0YSB0byBwb3B1bGF0ZVxuICBpZiAoIWNoYXJ0RGF0YSB8fCBjaGFydERhdGEubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbWF4WWVhciA9IE1hdGgubWF4KC4uLmNoYXJ0RGF0YS5tYXAoZCA9PiBkLlllYXJWYWwpKTtcbiAgY29uc3QgeSA9IHNlbGVjdGVkWWVhclZhbCA9PT0gbnVsbCA/IG1heFllYXIgOiBzZWxlY3RlZFllYXJWYWw7XG4gIHJldHVybiBjaGFydERhdGEuZmluZChkID0+IGQuWWVhclZhbCA9PT0geSkgfHwgY2hhcnREYXRhW2NoYXJ0RGF0YS5sZW5ndGggLSAxXTtcbn1cblxuLy8gSW50ZXJhY3RpdmUgUGxvdFxue1xuICBjb25zdCBtaW5ZZWFyID0gMjAwODtcbiAgY29uc3QgbWF4WWVhciA9IE1hdGgubWF4KC4uLnB1YnNfY2xlYW4ubWFwKGQgPT4gZC5ZZWFyKS5maWx0ZXIoeSA9PiBOdW1iZXIuaXNJbnRlZ2VyKHkpKSk7XG4gIFxuICBjb25zdCBtaW5EYXRlID0gbmV3IERhdGUobWluWWVhciwgMCwgMSk7XG4gIGNvbnN0IG1heERhdGUgPSBuZXcgRGF0ZShtYXhZZWFyLCAwLCAxKTtcbiAgXG4gIGNvbnN0IG5vZGUgPSBQbG90LnBsb3Qoe1xuICAgIHdpZHRoOiA5MDAsXG4gICAgaGVpZ2h0OiA0MDAsXG4gICAgbWFyZ2luVG9wOiAyMCxcbiAgICBtYXJnaW5SaWdodDogNDAsXG4gICAgbWFyZ2luQm90dG9tOiAzMCxcbiAgICBtYXJnaW5MZWZ0OiA1MCxcbiAgICBzdHlsZToge1xuICAgICAgYmFja2dyb3VuZDogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgZm9udEZhbWlseTogXCJTcGFjZSBHcm90ZXNrLCBzYW5zLXNlcmlmXCIsXG4gICAgICBmb250U2l6ZTogXCIxNHB4XCJcbiAgICB9LFxuICAgIHg6IHsgdHlwZTogXCJ0aW1lXCIsIGdyaWQ6IHRydWUsIGxhYmVsOiBudWxsLCBkb21haW46IFttaW5EYXRlLCBtYXhEYXRlXSwgaW5zZXRSaWdodDogMjAgfSxcbiAgICB5OiB7IGdyaWQ6IHRydWUsIGxhYmVsOiBcIkN1bXVsYXRpdmUgUHVibGljYXRpb25zXCIgfSxcbiAgICBtYXJrczogW1xuICAgICAgUGxvdC5saW5lWShjaGFydERhdGEsIHt4OiBcIlllYXJcIiwgeTogXCJDdW11bGF0aXZlXCIsIHN0cm9rZTogXCIjMDA3N2M4XCIsIHN0cm9rZVdpZHRoOiA0LCBjdXJ2ZTogXCJjYXRtdWxsLXJvbVwifSksXG4gICAgICBQbG90LmFyZWFZKGNoYXJ0RGF0YSwge3g6IFwiWWVhclwiLCB5OiBcIkN1bXVsYXRpdmVcIiwgZmlsbDogXCJ1cmwoI2dyYWRpZW50LWJsdWUpXCIsIGZpbGxPcGFjaXR5OiAwLjIsIGN1cnZlOiBcImNhdG11bGwtcm9tXCJ9KSxcbiAgICAgIC8vIFZpc2libGUgaW5kaWNhdG9yIGZvciB0aGUgc2VsZWN0ZWQgeWVhclxuICAgICAgUGxvdC5kb3QoW3NlbGVjdGVkWWVhckRhdGFdLmZpbHRlcihCb29sZWFuKSwge1xuICAgICAgICB4OiBcIlllYXJcIixcbiAgICAgICAgeTogXCJDdW11bGF0aXZlXCIsXG4gICAgICAgIHI6IDEwLFxuICAgICAgICBmaWxsOiBcIiMwMDc3YzhcIixcbiAgICAgICAgc3Ryb2tlOiBcIndoaXRlXCIsXG4gICAgICAgIHN0cm9rZVdpZHRoOiA0LFxuICAgICAgICBwb2ludGVyRXZlbnRzOiBcIm5vbmVcIlxuICAgICAgfSlcbiAgICBdXG4gIH0pO1xuICBcbiAgY29uc3Qgc3ZnID0gZDMuc2VsZWN0KG5vZGUpO1xuICBcbiAgLy8gTWFrZSBTVkcgcmVzcG9uc2l2ZVxuICBzdmcuYXR0cihcIndpZHRoXCIsIFwiMTAwJVwiKVxuICAgICAuYXR0cihcImhlaWdodFwiLCBcIjEwMCVcIilcbiAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAwIDkwMCA0MDBcIilcbiAgICAgLmF0dHIoXCJwcmVzZXJ2ZUFzcGVjdFJhdGlvXCIsIFwieE1pZFlNaWQgbWVldFwiKTtcbiAgXG4gIC8vIEFsbG93IGN1cnNvciB0byBpbmRpY2F0ZSBpbnRlcmFjdGl2aXR5XG4gIHN2Zy5zdHlsZShcImN1cnNvclwiLCBcInBvaW50ZXJcIik7XG4gIFxuICAvLyBBZGQgZ3JhZGllbnQgZGVmXG4gIHN2Zy5hcHBlbmQoXCJkZWZzXCIpLmFwcGVuZChcImxpbmVhckdyYWRpZW50XCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwiZ3JhZGllbnQtYmx1ZVwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCBcIjAlXCIpLmF0dHIoXCJ5MVwiLCBcIjAlXCIpLmF0dHIoXCJ4MlwiLCBcIjAlXCIpLmF0dHIoXCJ5MlwiLCBcIjEwMCVcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJzdG9wXCIpXG4gICAgICAuZGF0YShbe29mZnNldDogXCIwJVwiLCBjb2xvcjogXCIjMDA3N2M4XCJ9LCB7b2Zmc2V0OiBcIjEwMCVcIiwgY29sb3I6IFwidHJhbnNwYXJlbnRcIn1dKVxuICAgICAgLmpvaW4oXCJzdG9wXCIpXG4gICAgICAuYXR0cihcIm9mZnNldFwiLCBkID0+IGQub2Zmc2V0KVxuICAgICAgLmF0dHIoXCJzdG9wLWNvbG9yXCIsIGQgPT4gZC5jb2xvcik7XG5cbiAgLy8gQmluZCBjbGljayBldmVudCBkaXJlY3RseSB0byBTVkcgdG8gc2V0IG5lYXJlc3QgeWVhclxuICBzdmcub24oXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IGNvb3JkcyA9IGQzLnBvaW50ZXIoZXZlbnQsIHN2Zy5ub2RlKCkpO1xuICAgIGNvbnN0IHggPSBjb29yZHNbMF07XG4gICAgY29uc3QgaW5uZXJXaWR0aCA9IDkwMCAtIDUwIC0gNDA7XG4gICAgY29uc3QgcGxvdFggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihpbm5lcldpZHRoLCB4IC0gNTApKTsgXG4gICAgXG4gICAgY29uc3QgcmF0aW8gPSBwbG90WCAvIGlubmVyV2lkdGg7XG4gICAgY29uc3QgY2xpY2tlZFRpbWUgPSBtaW5EYXRlLmdldFRpbWUoKSArIHJhdGlvICogKG1heERhdGUuZ2V0VGltZSgpIC0gbWluRGF0ZS5nZXRUaW1lKCkpO1xuICAgIGNvbnN0IGNsaWNrZWRZZWFyID0gbmV3IERhdGUoY2xpY2tlZFRpbWUpLmdldEZ1bGxZZWFyKCk7XG4gICAgXG4gICAgLy8gc25hcCB0byBuZWFyZXN0IGV4aXN0aW5nIGNoYXJ0RGF0YSB5ZWFyXG4gICAgaWYgKGNoYXJ0RGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBjbG9zZXN0ID0gY2hhcnREYXRhLnJlZHVjZSgocHJldiwgY3VycikgPT4ge1xuICAgICAgICByZXR1cm4gKE1hdGguYWJzKGN1cnIuWWVhclZhbCAtIGNsaWNrZWRZZWFyKSA8IE1hdGguYWJzKHByZXYuWWVhclZhbCAtIGNsaWNrZWRZZWFyKSkgPyBjdXJyIDogcHJldjtcbiAgICAgIH0pO1xuICAgICAgbXV0YWJsZSBzZWxlY3RlZFllYXJWYWwgPSBjbG9zZXN0LlllYXJWYWw7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbm9kZTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgPGgzIGNsYXNzPVwidGV4dC1zbSBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIHRyYWNraW5nLXdpZGVzdCBtYi0zXCI+UGxhdGZvcm1zPC9oMz5gXG5cbnZpZXdvZiBzZWxlY3RlZFBsYXRmb3JtcyA9IElucHV0cy5jaGVja2JveChcbiAgW1wiQ29zTXhcIiwgXCJHZW9NeFwiLCBcIkF0b014XCIsIFwibkNvdW50ZXJcIl0sIFxuICB7dmFsdWU6IFtcIkNvc014XCIsIFwiR2VvTXhcIiwgXCJBdG9NeFwiLCBcIm5Db3VudGVyXCJdfVxuKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbjxoMyBjbGFzcz1cInRleHQtc20gZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSB0cmFja2luZy13aWRlc3QgbWItNFwiPlRvcCBDaXRlZCBQYXBlcnMgPHNwYW4gY2xhc3M9XCJ0ZXh0LXByaW1hcnlcIj4ke3NlbGVjdGVkWWVhckRhdGEgPyBzZWxlY3RlZFllYXJEYXRhLlllYXJWYWwgOiBcIlwifTwvc3Bhbj48L2gzPlxuJHtzZWxlY3RlZFllYXJEYXRhICYmIHNlbGVjdGVkWWVhckRhdGEuVG9wUGFwZXJzLmxlbmd0aCA+IDAgXG4gID8gYDxkaXYgY2xhc3M9XCJmbGV4IGZsZXgtY29sIGdhcC00XCI+XG4gICAgICAke3NlbGVjdGVkWWVhckRhdGEuVG9wUGFwZXJzLm1hcCgocCwgaSkgPT4gYFxuICAgICAgICA8YSBocmVmPVwiJHtwLkRPSX1cIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1cImdyb3VwIGJsb2NrIGJnLXNsYXRlLTUwIGhvdmVyOmJnLXNsYXRlLTEwMCByb3VuZGVkLXhsIHAtNCBib3JkZXIgYm9yZGVyLXNsYXRlLTEwMCB0cmFuc2l0aW9uLWNvbG9yc1wiPlxuICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleCBpdGVtcy1zdGFydCBnYXAtM1wiPlxuICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ3LTYgaC02IHJvdW5kZWQtZnVsbCAke2k9PT0wID8gJ2JnLWFtYmVyLTEwMCB0ZXh0LWFtYmVyLTcwMCcgOiAnYmctc2xhdGUtMjAwIHRleHQtc2xhdGUtNjAwJ30gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZm9udC1ib2xkIHRleHQteHMgc2hyaW5rLTBcIj4ke2krMX08L2Rpdj5cbiAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgPGg0IGNsYXNzPVwidGV4dC1zbGF0ZS05MDAgZm9udC1ib2xkIHRleHQtc20gZ3JvdXAtaG92ZXI6dGV4dC1wcmltYXJ5IHRyYW5zaXRpb24tY29sb3JzIGxpbmUtY2xhbXAtMyBsZWFkaW5nLXNudWdcIj4ke3AuVGl0bGV9PC9oND5cbiAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LVsxMXB4XSB0ZXh0LXNsYXRlLTUwMCBtdC0yIGZsZXggZmxleC1jb2wgZ2FwLTFcIj5cbiAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmb250LXNlcmlmIGl0YWxpYyBsaW5lLWNsYW1wLTFcIj4ke3AuSm91cm5hbH08L3NwYW4+XG4gICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZm9udC1tb25vIHRleHQtZW1lcmFsZC03MDAgZm9udC1ib2xkXCI+JHtwW1wiQ2l0ZWQgQnlcIl19IENpdGF0aW9uczwvc3Bhbj5cbiAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9hPlxuICAgICAgYCkuam9pbignJyl9XG4gICAgIDwvZGl2PmAgXG4gIDogYDxkaXYgY2xhc3M9XCJmbGV4LWdyb3cgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgdGV4dC1zbSBoLWZ1bGwgaXRhbGljIHRleHQtY2VudGVyIHAtNFwiPkNsaWNrIGFueXdoZXJlIG9uIHRoZSBjaGFydCBsaW5lIHRvIHZpZXcgdGhlIHRvcCBjaXRlZCBwYXBlcnMgZm9yIHRoYXQgeWVhci48L2Rpdj5gXG59YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8aDQgY2xhc3M9XCJ0ZXh0LTV4bCBmb250LWV4dHJhYm9sZCB0cmFja2luZy10aWdodCBtYi0yXCI+JHtmaWx0ZXJlZExpbmVQdWJzLmxlbmd0aC50b0xvY2FsZVN0cmluZygpfTwvaDQ+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoib2FfcGVyY2VudCA9IHtcbiAgaWYgKGZpbHRlcmVkTGluZVB1YnMubGVuZ3RoID09PSAwKSByZXR1cm4gMDsgLy8gUHJldmVudHMgYSBkaXZpZGUtYnktemVybyBlcnJvciBpZiBubyBib3hlcyBhcmUgY2hlY2tlZFxuICBjb25zdCBvYSA9IGZpbHRlcmVkTGluZVB1YnMuZmlsdGVyKGQgPT4gU3RyaW5nKGRbXCJPcGVuIEFjY2Vzc1wiXSkudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnKS5sZW5ndGg7XG4gIHJldHVybiBNYXRoLnJvdW5kKChvYSAvIGZpbHRlcmVkTGluZVB1YnMubGVuZ3RoKSAqIDEwMCk7XG59XG5odG1sYDxoNCBjbGFzcz1cInRleHQtNXhsIGZvbnQtZXh0cmFib2xkIHRleHQtc2xhdGUtOTAwIHRyYWNraW5nLXRpZ2h0IG1iLTJcIj4ke29hX3BlcmNlbnR9JTwvaDQ+YFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoib2FfcmluZyA9IHtcbiAgLy8gUXVhcnRvIGluaXRpYWxpemVzICd0aGlzJyBhcyBhbiBlbXB0eSBvYmplY3Qgb24gdGhlIGZpcnN0IHJ1bi4gXG4gIC8vIFdlIG11c3QgZXhwbGljaXRseSBjaGVjayBpZiBpdCBoYXMgYSB0YWdOYW1lIHRvIGVuc3VyZSBpdCdzIGEgcmVhbCBET00gZWxlbWVudC5cbiAgY29uc3QgaXNGaXJzdFJlbmRlciA9ICEodGhpcyAmJiB0aGlzLnRhZ05hbWUpO1xuICBcbiAgLy8gRWl0aGVyIGNyZWF0ZSBhIG5ldyBTVkcgb3IgcmV1c2UgdGhlIGV4aXN0aW5nIG9uZVxuICBjb25zdCBub2RlID0gaXNGaXJzdFJlbmRlciA/IGQzLmNyZWF0ZShcInN2Z1wiKS5ub2RlKCkgOiB0aGlzO1xuICBjb25zdCBzdmcgPSBkMy5zZWxlY3Qobm9kZSk7XG5cbiAgaWYgKGlzRmlyc3RSZW5kZXIpIHtcbiAgICBzdmcuYXR0cihcImNsYXNzXCIsIFwidy1mdWxsIGgtZnVsbCB0cmFuc2Zvcm0gLXJvdGF0ZS05MCBwb2ludGVyLWV2ZW50cy1ub25lXCIpXG4gICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFwiMCAwIDM2IDM2XCIpO1xuXG4gICAgLy8gMS4gRHJhdyB0aGUgYmFzZSBncmF5IHJpbmdcbiAgICBzdmcuYXBwZW5kKFwicGF0aFwiKVxuICAgICAgIC5hdHRyKFwiZFwiLCBcIk0xOCAyLjA4NDUgYSAxNS45MTU1IDE1LjkxNTUgMCAwIDEgMCAzMS44MzEgYSAxNS45MTU1IDE1LjkxNTUgMCAwIDEgMCAtMzEuODMxXCIpXG4gICAgICAgLmF0dHIoXCJmaWxsXCIsIFwibm9uZVwiKVxuICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiI2UyZThmMFwiKVxuICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIFwiM1wiKTtcblxuICAgIC8vIDIuIERyYXcgdGhlIG9yYW5nZSBhY3RpdmUgcmluZ1xuICAgIHN2Zy5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImFjdGl2ZS1yaW5nXCIpXG4gICAgICAgLmF0dHIoXCJkXCIsIFwiTTE4IDIuMDg0NSBhIDE1LjkxNTUgMTUuOTE1NSAwIDAgMSAwIDMxLjgzMSBhIDE1LjkxNTUgMTUuOTE1NSAwIDAgMSAwIC0zMS44MzFcIilcbiAgICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4gICAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjZjk3MzE2XCIpXG4gICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgXCIzXCIpXG4gICAgICAgLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiMCwgMTAwXCIpIFxuICAgICAgIC5zdHlsZShcInRyYW5zaXRpb25cIiwgXCJzdHJva2UtZGFzaGFycmF5IDFzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSlcIik7IC8vIFNtb290aCBDU1MgZWFzaW5nXG5cbiAgICAvLyAzLiBUcmlnZ2VyIHRoZSBpbml0aWFsIGFuaW1hdGlvbiBzbGlnaHRseSBhZnRlciB0aGUgY29tcG9uZW50IG1vdW50c1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZDMuc2VsZWN0KG5vZGUpLnNlbGVjdChcIi5hY3RpdmUtcmluZ1wiKS5hdHRyKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBgJHtvYV9wZXJjZW50fSwgMTAwYCk7XG4gICAgfSwgNTApO1xuICB9IGVsc2Uge1xuICAgIC8vIDQuIFJFQUNUSVZFIFVQREFURTogSWYgdGhlIFNWRyBhbHJlYWR5IGV4aXN0cywgc21vb3RobHkgY2hhbmdlIHRoZSBkYXNoYXJyYXlcbiAgICBzdmcuc2VsZWN0KFwiLmFjdGl2ZS1yaW5nXCIpLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIGAke29hX3BlcmNlbnR9LCAxMDBgKTtcbiAgfVxuXG4gIHJldHVybiBub2RlO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbjxzcGFuIGNsYXNzPVwidGV4dC0zeGwgZm9udC1leHRyYWJvbGQgdGV4dC1zbGF0ZS05MDAgbGVhZGluZy1ub25lXCI+JHt0b3BfaW5zdGl0dXRpb25zLnRvdGFsQWN0aXZlLnRvTG9jYWxlU3RyaW5nKCl9PC9zcGFuPlxuPHNwYW4gY2xhc3M9XCJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBmb250LW1lZGl1bSB1cHBlcmNhc2UgdHJhY2tpbmctd2lkZXIgbXQtMVwiPkFjdGl2ZSBDZW50ZXJzPC9zcGFuPlxuYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRvcF9pbnN0aXR1dGlvbnMgPSB7XG4gIC8vIEV4dHJhY3QgYW5kIHNwbGl0IGNvbW1hLXNlcGFyYXRlZCBpbnN0aXR1dGlvbnNcbiAgY29uc3QgYWxsSW5zdHMgPSBmaWx0ZXJlZExpbmVQdWJzLmZsYXRNYXAoZCA9PiAoZC5JbnN0aXR1dGlvbnMgfHwgXCJcIikuc3BsaXQoXCIsXCIpLm1hcChpID0+IGkudHJpbSgpKS5maWx0ZXIoaSA9PiBpICE9PSBcIlwiKSk7XG4gIGNvbnN0IGluc3RDb3VudHMgPSBkMy5yb2xsdXAoYWxsSW5zdHMsIHYgPT4gdi5sZW5ndGgsIGQgPT4gZCk7XG4gIC8vIFNvcnQgYW5kIHRha2UgdG9wIDEwXG4gIGNvbnN0IHNvcnRlZCA9IEFycmF5LmZyb20oaW5zdENvdW50cywgKFtuYW1lLCBjb3VudF0pID0+ICh7bmFtZSwgY291bnR9KSkuc29ydCgoYSxiKSA9PiBiLmNvdW50IC0gYS5jb3VudCk7XG4gIHJldHVybiB7XG4gICAgdG90YWxBY3RpdmU6IGluc3RDb3VudHMuc2l6ZSxcbiAgICB0b3AxMDogc29ydGVkLnNsaWNlKDAsIDEwKSxcbiAgICBtYXhDb3VudDogc29ydGVkLmxlbmd0aCA/IHNvcnRlZFswXS5jb3VudCA6IDFcbiAgfTtcbn1cblxuaHRtbGBcbjxkaXYgY2xhc3M9XCJmbGV4IGZsZXgtY29sIGdhcC0yIHctZnVsbCBncm91cC9jYXJkIGN1cnNvci1kZWZhdWx0IG10LWF1dG9cIj5cbiAgJHt0b3BfaW5zdGl0dXRpb25zLnRvcDEwLm1hcCgoaW5zdCwgaSkgPT4gYFxuICAgIDxkaXYgY2xhc3M9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyB0ZXh0LXhzIGZvbnQtbW9ubyB0ZXh0LXNsYXRlLTQwMCB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0zMDAgJHtpID49IDUgPyAnaC0wIG9wYWNpdHktMCBvdmVyZmxvdy1oaWRkZW4gZ3JvdXAtaG92ZXIvY2FyZDpoLVsxOHB4XSBncm91cC1ob3Zlci9jYXJkOm9wYWNpdHktMTAwIGdyb3VwLWhvdmVyL2NhcmQ6bXQtMScgOiAnaC1bMThweF0nfVwiPlxuICAgICAgPHNwYW4+JHtpIDwgOSA/ICcwJyA6ICcnfSR7aSsxfTwvc3Bhbj5cbiAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LWdyb3cgaC0yIGJnLXNsYXRlLTEwMCByb3VuZGVkLWZ1bGwgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJoLWZ1bGwgcm91bmRlZC1mdWxsICR7aT09PTAgPyAnYmctWyMyYTQ1MzRdJyA6IGk9PT0xID8gJ2JnLVsjZjk3MzE2XScgOiAnYmctc2xhdGUtNDAwJ31cIiBzdHlsZT1cIndpZHRoOiAkeyhpbnN0LmNvdW50IC8gdG9wX2luc3RpdHV0aW9ucy5tYXhDb3VudCkgKiAxMDB9JVwiPjwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8c3BhbiBjbGFzcz1cImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB3LWF1dG8gdHJ1bmNhdGUgbWF4LXctWzI1MHB4XSB0ZXh0LXJpZ2h0XCIgdGl0bGU9XCIke2luc3QubmFtZX1cIj4ke2luc3QubmFtZX08L3NwYW4+XG4gICAgPC9kaXY+XG4gIGApLmpvaW4oJycpfVxuICA8ZGl2IGNsYXNzPVwidGV4dC1bMTBweF0gdGV4dC1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgbXQtMiBpdGFsaWMgZ3JvdXAtaG92ZXIvY2FyZDpoaWRkZW5cIj5Ib3ZlciB0byBleHBhbmQgbGlzdDwvZGl2PlxuPC9kaXY+XG5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbjxzcGFuIGNsYXNzPVwidGV4dC0zeGwgZm9udC1leHRyYWJvbGQgdGV4dC1zbGF0ZS05MDAgbGVhZGluZy1ub25lXCI+JHt0b3BfdHlwZXMudG90YWxBY3RpdmV9PC9zcGFuPlxuPHNwYW4gY2xhc3M9XCJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBmb250LW1lZGl1bSB1cHBlcmNhc2UgdHJhY2tpbmctd2lkZXIgbXQtMVwiPkRpc3RpbmN0IEZvcm1hdHM8L3NwYW4+XG5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidG9wX3R5cGVzID0ge1xuICAvLyBVc2UgZmlsdGVyZWRMaW5lUHVicyBzbyB0eXBlcyByZWFjdCB0byBwbGF0Zm9ybSBzZWxlY3Rpb25cbiAgY29uc3QgYWxsVHlwZXMgPSBmaWx0ZXJlZExpbmVQdWJzLm1hcChkID0+IGQuVHlwZSB8fCBcIlVua25vd25cIik7XG4gIGNvbnN0IHR5cGVDb3VudHMgPSBkMy5yb2xsdXAoYWxsVHlwZXMsIHYgPT4gdi5sZW5ndGgsIGQgPT4gZCk7XG4gIC8vIFNvcnQgYW5kIHRha2UgdG9wIDEwXG4gIGNvbnN0IHNvcnRlZCA9IEFycmF5LmZyb20odHlwZUNvdW50cywgKFtuYW1lLCBjb3VudF0pID0+ICh7bmFtZSwgY291bnR9KSkuc29ydCgoYSxiKSA9PiBiLmNvdW50IC0gYS5jb3VudCk7XG4gIHJldHVybiB7XG4gICAgdG90YWxBY3RpdmU6IHR5cGVDb3VudHMuc2l6ZSxcbiAgICB0b3AxMDogc29ydGVkLnNsaWNlKDAsIDEwKSxcbiAgICBtYXhDb3VudDogc29ydGVkLmxlbmd0aCA/IHNvcnRlZFswXS5jb3VudCA6IDFcbiAgfTtcbn1cblxuaHRtbGBcbjxkaXYgY2xhc3M9XCJmbGV4IGZsZXgtY29sIGdhcC0yIHctZnVsbCBncm91cC9jYXJkIGN1cnNvci1kZWZhdWx0IG10LWF1dG9cIj5cbiAgJHt0b3BfdHlwZXMudG9wMTAubWFwKCh0eXBlT2JqLCBpKSA9PiBgXG4gICAgPGRpdiBjbGFzcz1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0zIHRleHQteHMgZm9udC1tb25vIHRleHQtc2xhdGUtNDAwIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMCAke2kgPj0gNSA/ICdoLTAgb3BhY2l0eS0wIG92ZXJmbG93LWhpZGRlbiBncm91cC1ob3Zlci9jYXJkOmgtWzE4cHhdIGdyb3VwLWhvdmVyL2NhcmQ6b3BhY2l0eS0xMDAgZ3JvdXAtaG92ZXIvY2FyZDptdC0xJyA6ICdoLVsxOHB4XSd9XCI+XG4gICAgICA8c3Bhbj4ke2kgPCA5ID8gJzAnIDogJyd9JHtpKzF9PC9zcGFuPlxuICAgICAgPGRpdiBjbGFzcz1cImZsZXgtZ3JvdyBoLTIgYmctc2xhdGUtMTAwIHJvdW5kZWQtZnVsbCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImgtZnVsbCByb3VuZGVkLWZ1bGwgJHtpPT09MCA/ICdiZy1za3ktNTAwJyA6IGk9PT0xID8gJ2JnLXZpb2xldC01MDAnIDogJ2JnLXNsYXRlLTQwMCd9XCIgc3R5bGU9XCJ3aWR0aDogJHsodHlwZU9iai5jb3VudCAvIHRvcF90eXBlcy5tYXhDb3VudCkgKiAxMDB9JVwiPjwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8c3BhbiBjbGFzcz1cImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB3LWF1dG8gdHJ1bmNhdGUgbWF4LXctWzI1MHB4XSB0ZXh0LXJpZ2h0IGNhcGl0YWxpemVcIiB0aXRsZT1cIiR7dHlwZU9iai5uYW1lfVwiPiR7dHlwZU9iai5uYW1lLnJlcGxhY2UoJy0nLCAnICcpfTwvc3Bhbj5cbiAgICA8L2Rpdj5cbiAgYCkuam9pbignJyl9XG4gIDxkaXYgY2xhc3M9XCJ0ZXh0LVsxMHB4XSB0ZXh0LWNlbnRlciB0ZXh0LXNsYXRlLTQwMCBtdC0yIGl0YWxpYyBncm91cC1ob3Zlci9jYXJkOmhpZGRlblwiPkhvdmVyIHRvIGV4cGFuZCBsaXN0PC9kaXY+XG48L2Rpdj5cbmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2VhcmNoVGVybSA9IElucHV0cy50ZXh0KHtwbGFjZWhvbGRlcjogXCJTZWFyY2ggZm9yIHBhcGVycyAoZS5nLiwgJ0x1bmcgQ2FuY2VyJykuLi5cIn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNvcnRCeSA9IElucHV0cy5zZWxlY3QoW1wiWWVhclwiLCBcIkNpdGVkIEJ5XCIsIFwiVGl0bGVcIl0sIHt2YWx1ZTogXCJZZWFyXCIsIGxhYmVsOiBcIlNvcnQgQnk6XCJ9KVxudmlld29mIHNvcnRPcmRlciA9IElucHV0cy5yYWRpbyhbXCJEZXNjXCIsIFwiQXNjXCJdLCB7dmFsdWU6IFwiRGVzY1wifSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmaWx0ZXJlZF9wdWJzID0ge1xuICAvLyBGaWx0ZXJcbiAgbGV0IGZpbHRlcmVkID0gcHVic19jbGVhbi5maWx0ZXIocCA9PiBcbiAgICAgIFN0cmluZyhwLlRpdGxlIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKSB8fCBcbiAgICAgIFN0cmluZyhwLkF1dGhvcnMgfHwgXCJcIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpXG4gICAgKTtcbiAgXG4gIC8vIFNvcnRcbiAgZmlsdGVyZWQuc29ydCgoYSwgYikgPT4ge1xuICAgIGxldCB2YWxBID0gYVtzb3J0QnldO1xuICAgIGxldCB2YWxCID0gYltzb3J0QnldO1xuICAgIFxuICAgIC8vIE51bWVyaWMgZmFsbGJhY2tcbiAgICBpZiAoc29ydEJ5ID09PSBcIlllYXJcIiB8fCBzb3J0QnkgPT09IFwiQ2l0ZWQgQnlcIikge1xuICAgICAgdmFsQSA9IE51bWJlcih2YWxBKSB8fCAwO1xuICAgICAgdmFsQiA9IE51bWJlcih2YWxCKSB8fCAwO1xuICAgICAgcmV0dXJuIHNvcnRPcmRlciA9PT0gXCJEZXNjXCIgPyB2YWxCIC0gdmFsQSA6IHZhbEEgLSB2YWxCO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdHJpbmcgY29tcGFyZVxuICAgICAgdmFsQSA9IFN0cmluZyh2YWxBIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICB2YWxCID0gU3RyaW5nKHZhbEIgfHwgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICh2YWxBIDwgdmFsQikgcmV0dXJuIHNvcnRPcmRlciA9PT0gXCJEZXNjXCIgPyAxIDogLTE7XG4gICAgICBpZiAodmFsQSA+IHZhbEIpIHJldHVybiBzb3J0T3JkZXIgPT09IFwiRGVzY1wiID8gLTEgOiAxO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9KTtcbiAgXG4gIHJldHVybiBmaWx0ZXJlZDtcbn1cblxuLy8gSW1wbGVtZW50IGJhc2ljIHBhZ2luYXRpb24gc28gdGhlIHBhZ2UgZG9lc24ndCBsYWcgaWYgdGhleSBleHBhbmQgaXRcbnZpZXdvZiBwYWdlSW5kZXggPSBJbnB1dHMucmFuZ2UoWzAsIE1hdGgubWF4KDAsIE1hdGguY2VpbChmaWx0ZXJlZF9wdWJzLmxlbmd0aCAvIDIwKSAtIDEpXSwge3ZhbHVlOiAwLCBzdGVwOiAxLCBsYWJlbDogXCJQYWdlXCJ9KVxuXG5odG1sYFxuPGRpdiBjbGFzcz1cImRpdmlkZS15IGRpdmlkZS1zbGF0ZS0xMDBcIj5cbiAgJHtmaWx0ZXJlZF9wdWJzLnNsaWNlKHBhZ2VJbmRleCAqIDIwLCAocGFnZUluZGV4ICsgMSkgKiAyMCkubWFwKHAgPT4gaHRtbGBcbiAgICA8ZGl2IGNsYXNzPVwiZ3JvdXAgaG92ZXI6YmctWyNGMEY5RkZdIHRyYW5zaXRpb24tY29sb3JzIGN1cnNvci1wb2ludGVyXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiZ3JpZCBncmlkLWNvbHMtMTIgZ2FwLTQgcHgtOCBweS01IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNwYW4tNVwiPlxuICAgICAgICAgIDxoNCBjbGFzcz1cInRleHQtc2xhdGUtOTAwIGZvbnQtYm9sZCB0ZXh0LWxnIGdyb3VwLWhvdmVyOnRleHQtcHJpbWFyeSB0cmFuc2l0aW9uLWNvbG9yc1wiPlxuICAgICAgICAgICAgPGEgaHJlZj1cIiR7cC5ET0l9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtwLlRpdGxlfTwvYT5cbiAgICAgICAgICA8L2g0PlxuICAgICAgICAgIDxwIGNsYXNzPVwidGV4dC1zbSB0ZXh0LXNsYXRlLTUwMCBtdC0xIGxpbmUtY2xhbXAtMVwiPiR7cC5BdXRob3JzfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc3Bhbi0yIHRleHQtc2xhdGUtNzAwIGZvbnQtc2VyaWYgaXRhbGljIGxpbmUtY2xhbXAtMlwiPiR7cC5Kb3VybmFsfTwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNwYW4tMSB0ZXh0LXNsYXRlLTUwMCBmb250LW1vbm9cIj4ke3AuWWVhcn08L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zcGFuLTEgdGV4dC1zbGF0ZS01MDAgZm9udC1tb25vXCI+PHNwYW4gY2xhc3M9XCJiZy1zbGF0ZS0xMDAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgdGV4dC1zbGF0ZS02MDAgcHgtMyBweS0wLjUgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1ib2xkXCI+JHtwW1wiQ2l0ZWQgQnlcIl0gfHwgMH08L3NwYW4+PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc3Bhbi0xXCI+XG4gICAgICAgICAgJHtTdHJpbmcocFtcIk9wZW4gQWNjZXNzXCJdKS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZScgPyBodG1sYDxzcGFuIGNsYXNzPVwiaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIGdhcC0xLjUgcHgtMi41IHB5LTEgcm91bmRlZC1tZCB0ZXh0LVsxMHB4XSBmb250LWJvbGQgYmctb3JhbmdlLTUwIHRleHQtb3JhbmdlLTYwMCBib3JkZXIgYm9yZGVyLW9yYW5nZS0xMDAgdXBwZXJjYXNlIHRyYWNraW5nLXdpZGVyXCI+PHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkIHRleHQtWzEycHhdXCI+bG9ja19vcGVuPC9zcGFuPiBPcGVuPC9zcGFuPmAgOiAnJ31cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc3Bhbi0yIHRleHQtcmlnaHRcIj5cbiAgICAgICAgICAke3AuSGFzX0Nvc014ID09ICdUcnVlJyA/IGh0bWxgPHNwYW4gY2xhc3M9XCJpbmxpbmUtZmxleCBtLTAuNSBpdGVtcy1jZW50ZXIgcHgtMi41IHB5LTAuNSByb3VuZGVkLWZ1bGwgdGV4dC14cyBmb250LW1lZGl1bSBiZy1ibHVlLTEwMCB0ZXh0LWJsdWUtODAwXCI+Q29zTXg8L3NwYW4+YCA6ICcnfVxuICAgICAgICAgICR7cC5IYXNfR2VvTXggPT0gJ1RydWUnID8gaHRtbGA8c3BhbiBjbGFzcz1cImlubGluZS1mbGV4IG0tMC41IGl0ZW1zLWNlbnRlciBweC0yLjUgcHktMC41IHJvdW5kZWQtZnVsbCB0ZXh0LXhzIGZvbnQtbWVkaXVtIGJnLWVtZXJhbGQtMTAwIHRleHQtZW1lcmFsZC04MDBcIj5HZW9NeDwvc3Bhbj5gIDogJyd9XG4gICAgICAgICAgJHtwLkhhc19BdG9NeCA9PSAnVHJ1ZScgPyBodG1sYDxzcGFuIGNsYXNzPVwiaW5saW5lLWZsZXggbS0wLjUgaXRlbXMtY2VudGVyIHB4LTIuNSBweS0wLjUgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1tZWRpdW0gYmctaW5kaWdvLTEwMCB0ZXh0LWluZGlnby04MDBcIj5BdG9NeDwvc3Bhbj5gIDogJyd9XG4gICAgICAgICAgJHtwLkhhc19uQ291bnRlciA9PSAnVHJ1ZScgPyBodG1sYDxzcGFuIGNsYXNzPVwiaW5saW5lLWZsZXggbS0wLjUgaXRlbXMtY2VudGVyIHB4LTIuNSBweS0wLjUgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1tZWRpdW0gYmctcHVycGxlLTEwMCB0ZXh0LXB1cnBsZS04MDBcIj5uQ291bnRlcjwvc3Bhbj5gIDogJyd9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGApfVxuPGRpdiBjbGFzcz1cImJnLXNsYXRlLTUwIHB4LTggcHktNCBib3JkZXItdCBib3JkZXItc2xhdGUtMjAwIGZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuPHNwYW4gY2xhc3M9XCJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwXCI+U2hvd2luZyBwYWdlICR7cGFnZUluZGV4ICsgMX0gb2YgJHtNYXRoLm1heCgxLCBNYXRoLmNlaWwoZmlsdGVyZWRfcHVicy5sZW5ndGggLyAyMCkpfSAoJHtmaWx0ZXJlZF9wdWJzLmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSB0b3RhbCByZXN1bHRzKTwvc3Bhbj5cbjwvZGl2PlxuPC9kaXY+XG5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdGVkUGxhdGZvcm1zJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlYXJjaFRlcm0nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc29ydEJ5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NvcnRPcmRlcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwYWdlSW5kZXgnKSJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../bbytes/pub_tracker";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
  tabsets.forEach(function(tabset) {
    const tabby = new Tabby('#' + tabset.id);
  });
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/nanostring-biostats\.github\.io\/CosMx-Analysis-Scratch-Space");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>




</body></html>